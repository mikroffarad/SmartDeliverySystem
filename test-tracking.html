<!DOCTYPE h <script>
const connection = new signalR.HubConnectionBuilder()
.withUrl("http://localhost:5145/deliveryHub", {
withCredentials: true
})
.configureLogging(signalR.LogLevel.Information)
.build();html>

<head>
    <title>Smart Delivery Tracking</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/7.0.0/signalr.min.js"></script>
</head>

<body>
    <h1>ğŸš› Smart Delivery Real-time Tracking</h1>
    <div id="messages"></div>
    <script>
        const connection = new signalR.HubConnectionBuilder()
            .withUrl("https://localhost:7183/deliveryHub", {
                withCredentials: true
            })
            .configureLogging(signalR.LogLevel.Information)
            .build();

        // ĞŸÑ–Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ½Ñ Ğ´Ğ¾ Ğ²ÑÑ–Ñ… Ğ´Ğ¾ÑÑ‚Ğ°Ğ²Ğ¾Ğº
        connection.start().then(function () {
            console.log("âœ… Connected to SignalR Hub");
            connection.invoke("JoinAllDeliveries");
            addMessage("ğŸ”— Connected to delivery tracking");
        }).catch(function (err) {
            console.error("âŒ SignalR Error: " + err.toString());
            addMessage("âŒ Connection failed: " + err.toString());
        });        // Ğ¡Ğ»ÑƒÑ…Ğ°Ñ”Ğ¼Ğ¾ GPS Ğ¾Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ
        connection.on("LocationUpdated", function (data) {
            console.log("ğŸ“ Raw GPS Data received:", data);
            console.log("ğŸ“ Type of data:", typeof data);
            console.log("ğŸ“ Data keys:", Object.keys(data));

            addMessage(`ğŸ“ Delivery ${data.deliveryId}: ${data.latitude}, ${data.longitude} - ${data.notes || 'No notes'}`);
        });

        // Ğ¡Ğ»ÑƒÑ…Ğ°Ñ”Ğ¼Ğ¾ ÑÑ‚Ğ°Ñ‚ÑƒÑ Ğ¾Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ
        connection.on("StatusUpdated", function (data) {
            console.log("ğŸ“Š Status Update:", data);
            addMessage(`ğŸ“Š Delivery ${data.DeliveryId}: Status changed to ${data.Status}`);
        });

        function addMessage(message) {
            const div = document.getElementById("messages");
            const p = document.createElement("p");
            p.textContent = new Date().toLocaleTimeString() + " - " + message;
            div.appendChild(p);
        }
    </script>
</body>

</html>
